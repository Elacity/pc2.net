const m=async(t,r,e,i=o=>o,...n)=>{let o=new t(e);return o=i(o)??o,await r.send(o,...n)};function w(t,r,e,i,n){return async function*(a,s,...f){const c=s;let d=a.startingToken??c[e],p=!0,l;for(;p;){if(c[e]=d,n&&(c[n]=c[n]??a.pageSize),a.client instanceof t)l=await m(r,a.client,s,a.withCommand,...f);else throw new Error(`Invalid client, expected instance of ${t.name}`);yield l;const u=d;d=h(l,i),p=!!(d&&(!a.stopOnSameToken||d!==u))}return void 0}}const h=(t,r)=>{let e=t;const i=r.split(".");for(const n of i){if(!e||typeof e!="object")return;e=e[n]}return e},y=(t,r)=>{for(const e of Object.keys(t)){const i=t[e],n=async function(a,s,f){const c=new i(a);if(typeof s=="function")this.send(c,s);else if(typeof f=="function"){if(typeof s!="object")throw new Error(`Expected http options but got ${typeof s}`);this.send(c,s||{},f)}else return this.send(c,s)},o=(e[0].toLowerCase()+e.slice(1)).replace(/Command$/,"");r.prototype[o]=n}};export{w as a,y as c};
