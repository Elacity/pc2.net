let bypassEditorChangeHandlerOnce=!1,unsavedChanges=!1,defaultZoom=12,fontSize=defaultZoom,default_file_name="Untitled.txt",curfile,translate_to_lang;var show_status_bar=localStorage.getItem("show_status_bar"),show_doc_stats=(toggle_status_bar(null===show_status_bar||"1"===show_status_bar?"show":"hide"),localStorage.getItem("show_doc_stats"));function update_doc_stats(){var content=editor.getValue();$("#word-count").html(""===content.trim()?0:editor.getValue().split(" ").length),$("#paragraph-count").html(""===content.trim()?0:editor.getValue().replace(/\n$/gm,"").split(/\n/).length),$("#letter-count").html(""===content.trim()?0:editor.getValue().length)}function toggle_word_count(toggle){"show"===toggle?(localStorage.setItem("show_doc_stats","1"),show_doc_stats="1",$(".doc-stats").show(),$('[data-action="show-word-count"]').removeClass("dropdown-item-hide-icon"),toggle_status_bar("show")):(localStorage.setItem("show_doc_stats","0"),show_doc_stats="0",$('[data-action="show-word-count"]').addClass("dropdown-item-hide-icon"),$(".doc-stats").hide())}function toggle_status_bar(toggle){"show"===toggle?(show_status_bar="1",localStorage.setItem("show_status_bar","1"),$("#editor").css("height","calc(100vh - 55px)"),$(".status-bar").show(),$('[data-action="show-status-bar"]').removeClass("dropdown-item-hide-icon")):(show_doc_stats=show_status_bar="0",localStorage.setItem("show_status_bar","0"),localStorage.setItem("show_doc_stats","0"),$("#editor").css("height","calc(100vh - 28px)"),$(".status-bar").hide(),$('[data-action="show-status-bar"]').addClass("dropdown-item-hide-icon"),$('[data-action="show-word-count"]').addClass("dropdown-item-hide-icon"))}null!==show_doc_stats&&"0"!==show_doc_stats||(localStorage.setItem("show_doc_stats","0"),show_doc_stats="0",$(".doc-stats").hide()),"1"===show_doc_stats&&(localStorage.setItem("show_doc_stats","1"),show_doc_stats="1",$(".doc-stats").show(),toggle_status_bar("show"));let show_line_numbers=localStorage.getItem("show_line_numbers"),line_wrap=(null===show_line_numbers&&(localStorage.setItem("show_line_numbers","0"),show_line_numbers="0"),localStorage.getItem("line_wrap")),minimap=(null===line_wrap&&(localStorage.setItem("line_wrap","0"),line_wrap="0"),localStorage.getItem("minimap")),font_family=(null===minimap&&(localStorage.setItem("minimap","0"),minimap="0"),localStorage.getItem("font_family")),background_color=(fontSize=null===(fontSize=localStorage.getItem("fontSize"))?(localStorage.setItem("fontSize",defaultZoom),defaultZoom):parseInt(fontSize),localStorage.getItem("background_color")),text_color=(null===background_color&&(background_color="ffffff",localStorage.setItem("background_color",background_color),$("#editor").css("background-color","#"+background_color)),localStorage.getItem("text_color"));function open_local_file(){$("#file-input").trigger("click"),document.getElementById("file-input").addEventListener("change",e=>{var file=e.target.files[0];file&&((e=new FileReader).onload=function(e){default_file_name=file.name,puter.ui.setWindowTitle(default_file_name),set_editor_options_based_on_language(get_language_from_filename(default_file_name),editor),bypassEditorChangeHandlerOnce=!0,editor.setValue(e.target.result),curfile=void 0},e.readAsText(file))},!1)}async function open_file(cfile){$(".app-area").hide(),puter.ui.setWindowTitle(cfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor),bypassEditorChangeHandlerOnce=!0,editor.setValue(await(await cfile.read()).text())}async function save_file(callback){puter.ui.setWindowTitle(curfile.name),await curfile.write(editor.getValue()),unsavedChanges=!1,$("#dropdown-item-save").addClass("dropdown-item-disabled"),puter.ui.setWindowTitle(curfile.name),callback&&"function"==typeof callback&&callback(curfile)}function get_language_from_filename(filename){return filename=filename.toLowerCase(),language=filename.endsWith(".c")?"c":filename.endsWith(".cpp")||filename.endsWith(".h")?"cpp":filename.endsWith(".css")?"css":filename.endsWith(".go")?"go":filename.endsWith(".htm")||filename.endsWith(".html")||filename.endsWith(".xhtml")?"html":filename.endsWith(".java")?"java":filename.endsWith(".js")?"javascript":filename.endsWith(".json")||filename.endsWith(".lock")?"json":filename.endsWith(".jl")?"julia":filename.endsWith(".kt")?"kotlin":filename.endsWith(".lua")?"lua":filename.endsWith(".md")?"markdown":filename.endsWith(".php")||filename.endsWith(".phar")?"php":filename.endsWith(".pl")?"perl":filename.endsWith(".py")?"python":filename.endsWith(".r")||filename.endsWith(".rdata")||filename.endsWith(".rds")||filename.endsWith(".rda")?"r":filename.endsWith(".rb")?"ruby":filename.endsWith(".rs")||filename.endsWith(".rlib")?"rust":filename.endsWith(".scala")||filename.endsWith(".sc")?"scala":filename.endsWith(".scm")?"scheme":filename.endsWith(".sol")?"solidity":filename.endsWith(".sql")?"sql":filename.endsWith(".svg")?"xml":filename.endsWith(".swift")?"swift":filename.endsWith(".typescript")?"typescript":filename.endsWith(".xml")?"xml":filename.endsWith(".yaml")?"yaml":"plaintext"}function set_editor_options_based_on_language(language,editor_instance){monaco.editor.setModelLanguage(editor_instance.getModel(),language),"plaintext"===language?editor_instance.updateOptions({language:language,lineNumbers:"1"===show_line_numbers?"on":"off",lineNumbersMinChars:"1"===show_line_numbers?1:0,lineDecorationsWidth:"1"===show_line_numbers?17:0,wordWrap:"1"===line_wrap?"on":"off",quickSuggestions:!1,glyphMargin:"1"===show_line_numbers,folding:!1,renderLineHighlight:"none",autoClosingBrackets:!1,matchBrackets:!1,selectionHighlight:!1}):(show_line_numbers="1",$('[data-action="show-line-numbers"]').removeClass("dropdown-item-hide-icon"),$('[data-action="show-line-numbers"]').addClass("dropdown-item-disabled"),editor_instance.updateOptions({language:language,lineNumbers:"on",lineNumbersMinChars:1,lineDecorationsWidth:1,quickSuggestions:!0,glyphMargin:!0,renderLineHighlight:"all",autoClosingBrackets:!0,matchBrackets:!0,selectionHighlight:!0,folding:!0}))}async function attempt_exit(){var alert_resp;!unsavedChanges||"Don't Save"===(alert_resp=await puter.ui.alert("Do you want to save the changes you made?",[{label:"Save",type:"primary"},{label:"Don't Save"},{label:"Cancel"}]))?puter.exit():"Save"===alert_resp&&(curfile?save_file(()=>{puter.exit()}):(curfile=await puter.ui.showSaveFilePicker(editor.getValue(),default_file_name),unsavedChanges=!1,puter.ui.setWindowTitle(curfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor),puter.exit()))}async function curfileViaFileDialog(){var alert_resp;unsavedChanges?"Don't Save"===(alert_resp=await puter.ui.alert("Do you want to save the changes you made?",[{label:"Save",type:"primary"},{label:"Don't Save"},{label:"Cancel"}]))?(curfile=await puter.ui.showOpenFilePicker(),unsavedChanges=!1,open_file(curfile)):"Save"===alert_resp&&(curfile?save_file(async()=>{unsavedChanges=!1,$("#dropdown-item-save").addClass("dropdown-item-disabled"),open_file(curfile=await puter.ui.showOpenFilePicker())}):(await puter.ui.showSaveFilePicker(editor.getValue(),curfile?curfile.name:default_file_name),open_file(curfile=await puter.ui.showOpenFilePicker()),puter.ui.setWindowTitle(curfile.name)),unsavedChanges=!1):open_file(curfile=await puter.ui.showOpenFilePicker())}function saveTextAsFile(textToWrite){var textToWrite=new Blob([textToWrite],{type:"text/plain"}),fileNameToSaveAs=curfile?curfile.name:"file.txt",downloadLink=document.createElement("a");downloadLink.download=fileNameToSaveAs,downloadLink.innerHTML="Download File",null!=window.webkitURL?downloadLink.href=window.webkitURL.createObjectURL(textToWrite):(downloadLink.href=window.URL.createObjectURL(textToWrite),downloadLink.onclick=event=>{document.body.removeChild(event.target)},downloadLink.style.display="none",document.body.appendChild(downloadLink)),downloadLink.click()}async function summarize(ed){var selection=ed.getSelection(),selection=ed.getModel().getValueInRange(selection);if((selection=selection||ed.getValue()).length<50)puter.ui.alert("Please select at least 50 characters to summarize.");else{ed=Date.now();const dialog=document.createElement("dialog");dialog.classList.add("ai-magic-dialog"),dialog.innerHTML=`
        <div class="ai-magic-container">
            <div class="spinner-border" role="status">
                <svg class="magic-wand-move" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" stroke-width="2"><g stroke-width="2" transform="translate(0, 0)"><polyline points="28 20 29.072 18.927 4 44" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" stroke-linejoin="miter"></polyline><polygon points="39.325 13.703 41.683 6.317 34.296 8.675 28 4.15 28 12 21.71 16.493 29.072 18.927 31.507 26.289 36.096 20 43.85 20 39.325 13.703" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" data-color="color-2" stroke-linejoin="miter"></polygon><path d="M16,10c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path><path d="M44,38c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path></g></svg>
                <span class="sr-only">Performing AI magic!</span>
                <span class="puterjs-footer">Powered by <a href="https://docs.puter.com" target="_blank">Puter.JS</a></span>
            </div>
        </div>
    `,document.body.appendChild(dialog),dialog.showModal();let newText;try{newText=await puter.ai.chat("Please provide a concise summary of the following text. Keep the summary as brief as possible while capturing the key points. Do not include any additional descriptions or explanations. Retain the original language of the text without any translation. Text: "+html_encode(selection),!1)}catch(e){return alert("Error: "+e.error.message),dialog.close(),void dialog.remove()}setTimeout(()=>{dialog.innerHTML=`
            <div style="margin: 40px; max-width: 500px;">
                <div style="margin-bottom: 20px; font-size: 18px; font-weight: 500;">Summary</div>
                <span class="close-x">✕</span>
                <div class="summary-txt">${wrapParagraphsInPTags(html_encode(newText.toString()))}</div>
                <button class="regenerate regenerate-summary">Regenerate</button>

            </div>
        `},Math.max(0,1e3-(Date.now()-ed)))}}async function eli5(ed){var selection=ed.getSelection(),selection=ed.getModel().getValueInRange(selection);if((selection=selection||ed.getValue()).length<10)puter.ui.alert(`Please select at least 10 characters to "Explain like I'm 5!".`);else{ed=Date.now();const dialog=document.createElement("dialog");dialog.classList.add("ai-magic-dialog"),dialog.innerHTML=`
        <div class="ai-magic-container">
            <div class="spinner-border" role="status">
                <svg class="magic-wand-move" style="display:block; margin:10px auto 30px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" stroke-width="2"><g stroke-width="2" transform="translate(0, 0)"><polyline points="28 20 29.072 18.927 4 44" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" stroke-linejoin="miter"></polyline><polygon points="39.325 13.703 41.683 6.317 34.296 8.675 28 4.15 28 12 21.71 16.493 29.072 18.927 31.507 26.289 36.096 20 43.85 20 39.325 13.703" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" data-color="color-2" stroke-linejoin="miter"></polygon><path d="M16,10c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path><path d="M44,38c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path></g></svg>
                <span class="sr-only">Performing AI magic!</span>
                <span class="puterjs-footer">Powered by <a href="https://docs.puter.com" target="_blank">Puter.JS</a></span>
            </div>
        </div>
    `,document.body.appendChild(dialog),dialog.showModal();let newText;try{newText=await puter.ai.chat("Could you please explain this text to me in simpler terms, like I am 10 years old. Text: "+html_encode(selection),!1)}catch(e){return alert("Error: "+e.error.message),dialog.close(),void dialog.remove()}setTimeout(()=>{dialog.innerHTML=`
            <div style="margin: 40px; max-width: 500px;">
                <div style="margin-bottom: 20px; font-size: 18px; font-weight: 500;">Explained in simple terms:</div>
                <span class="close-x">✕</span>
                <div class="summary-txt">${wrapParagraphsInPTags(html_encode(newText.toString()))}</div>
                <button class="regenerate regenerate-eli5">Regenerate</button>
            </div>
        `},Math.max(0,1e3-(Date.now()-ed)))}}async function toneAnalyzer(ed){var selection=ed.getSelection(),selection=ed.getModel().getValueInRange(selection);if((selection=selection||ed.getValue()).length<10)puter.ui.alert(`Please select at least 10 characters to "Explain like I'm 5!".`);else{ed=Date.now();const dialog=document.createElement("dialog");dialog.classList.add("ai-magic-dialog"),dialog.innerHTML=`
        <div class="ai-magic-container">
            <div class="spinner-border" role="status">
                <svg class="magic-wand-move" style="display:block; margin:10px auto 30px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" stroke-width="2"><g stroke-width="2" transform="translate(0, 0)"><polyline points="28 20 29.072 18.927 4 44" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" stroke-linejoin="miter"></polyline><polygon points="39.325 13.703 41.683 6.317 34.296 8.675 28 4.15 28 12 21.71 16.493 29.072 18.927 31.507 26.289 36.096 20 43.85 20 39.325 13.703" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" data-color="color-2" stroke-linejoin="miter"></polygon><path d="M16,10c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path><path d="M44,38c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path></g></svg>
                <span class="sr-only">Performing AI magic!</span>
                <span class="puterjs-footer">Powered by <a href="https://docs.puter.com" target="_blank">Puter.JS</a></span>
            </div>
        </div>
    `,document.body.appendChild(dialog),dialog.showModal();let newText;try{newText=await puter.ai.chat(`Please analyze the emotional tone of the following text. Identify the predominant emotion conveyed (e.g., happiness, sadness, anger, excitement, etc.) and provide a brief explanation of how you determined this tone based on the language, phrases, or specific words used in the text. Please refrain from small talk or confirmations and only provide the results to my request. Please always start your response by the mood detected and then provide your reasons. START INPUT TEXT: """"${html_encode(selection)}"""" END INPUT TEXT`,!1)}catch(e){return alert("Error: "+e.error.message),dialog.close(),void dialog.remove()}setTimeout(()=>{dialog.innerHTML=`
            <div style="margin: 40px; max-width: 500px;">
                <div style="margin-bottom: 20px; font-size: 18px; font-weight: 500;">Tone analysis:</div>
                <span class="close-x">✕</span>
                <div class="summary-txt">${wrapParagraphsInPTags(html_encode(newText.toString()))}</div>
                <button class="regenerate regenerate-tone-analyzer">Regenerate</button>
            </div>
        `},Math.max(0,1e3-(Date.now()-ed)))}}async function generateQuestions(ed){var selection=ed.getSelection(),selection=ed.getModel().getValueInRange(selection);if((selection=selection||ed.getValue()).length<10)puter.ui.alert(`Please select at least 10 characters to "Explain like I'm 5!".`);else{ed=Date.now();const dialog=document.createElement("dialog");dialog.classList.add("ai-magic-dialog"),dialog.innerHTML=`
        <div class="ai-magic-container">
            <div class="spinner-border" role="status">
                <svg class="magic-wand-move" style="display:block; margin:10px auto 30px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" stroke-width="2"><g stroke-width="2" transform="translate(0, 0)"><polyline points="28 20 29.072 18.927 4 44" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" stroke-linejoin="miter"></polyline><polygon points="39.325 13.703 41.683 6.317 34.296 8.675 28 4.15 28 12 21.71 16.493 29.072 18.927 31.507 26.289 36.096 20 43.85 20 39.325 13.703" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" data-color="color-2" stroke-linejoin="miter"></polygon><path d="M16,10c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path><path d="M44,38c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path></g></svg>
                <span class="sr-only">Performing AI magic!</span>
                <span class="puterjs-footer">Powered by <a href="https://docs.puter.com" target="_blank">Puter.JS</a></span>
            </div>
        </div>
    `,document.body.appendChild(dialog),dialog.showModal();let newText;try{newText=await puter.ai.chat(`Based on the provided text, generate a set of questions that cover the key themes, facts, or ideas presented. Aim to create questions that provoke thought, enhance comprehension, or encourage deeper exploration of the subject matter.. START INPUT TEXT: """"${html_encode(selection)}"""" END INPUT TEXT`,!1)}catch(e){return alert("Error: "+e.error.message),dialog.close(),void dialog.remove()}setTimeout(()=>{dialog.innerHTML=`
            <div style="margin: 40px; max-width: 500px;">
                <div style="margin-bottom: 20px; font-size: 18px; font-weight: 500;">Generated questions:</div>
                <span class="close-x">✕</span>
                <div class="summary-txt">${wrapParagraphsInPTags(html_encode(newText.toString()))}</div>
                <button class="regenerate regenerate-questions">Regenerate</button>
            </div>
        `},Math.max(0,1e3-(Date.now()-ed)))}}async function translate(ed,to_lang){translate_to_lang=to_lang;var selection=ed.getSelection(),selection=ed.getModel().getValueInRange(selection);if((selection=selection||ed.getValue()).length<10)puter.ui.alert(`Please select at least 10 characters to "Explain like I'm 5!".`);else{ed=Date.now();const dialog=document.createElement("dialog");dialog.classList.add("ai-magic-dialog"),dialog.innerHTML=`
        <div class="ai-magic-container">
            <div class="spinner-border" role="status">
                <svg class="magic-wand-move" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" stroke-width="2"><g stroke-width="2" transform="translate(0, 0)"><polyline points="28 20 29.072 18.927 4 44" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" stroke-linejoin="miter"></polyline><polygon points="39.325 13.703 41.683 6.317 34.296 8.675 28 4.15 28 12 21.71 16.493 29.072 18.927 31.507 26.289 36.096 20 43.85 20 39.325 13.703" fill="none" stroke="#444444" stroke-linecap="square" stroke-miterlimit="10" stroke-width="2" data-color="color-2" stroke-linejoin="miter"></polygon><path d="M16,10c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path><path d="M44,38c-3.314,0-6,2.686-6,6,0-3.314-2.686-6-6-6,3.314,0,6-2.686,6-6,0,3.314,2.686,6,6,6Z" fill="none" stroke="#444444" stroke-miterlimit="10" stroke-width="2" data-cap="butt" stroke-linecap="butt" stroke-linejoin="miter"></path></g></svg>
                <span class="sr-only">Performing AI magic!</span>
                <span class="puterjs-footer">Powered by <a href="https://docs.puter.com" target="_blank">Puter.JS</a></span>
            </div>
        </div>
    `,document.body.appendChild(dialog),dialog.showModal();let newText;try{newText=await puter.ai.chat(`Please provide an accurate translation of the following text into ${html_encode(to_lang)}. The response should consist only of the translated text, with no additional explanations, comments, or small talk. The translation should be precise, accurate, and faithful to the original text. Do not add or subtract any text from your response.

        START INPUT TEXT: """"${html_encode(selection)}"""" END INPUT TEXT`,!1)}catch(e){return alert("Error: "+e.error.message),dialog.close(),void dialog.remove()}setTimeout(()=>{dialog.innerHTML=`
            <div style="margin: 40px; max-width: 500px;">
                <div style="margin-bottom: 20px; font-size: 18px; font-weight: 500;">Translation to ${html_encode(to_lang)}:</div>
                <span class="close-x">✕</span>
                <div class="summary-txt">${wrapParagraphsInPTags(html_encode(newText.toString()))}</div>
                <button class="regenerate regenerate-translation">Regenerate</button>

            </div>
        `},Math.max(0,1e3-(Date.now()-ed)))}}function wrapParagraphsInPTags(text){return text.split("\n").map(paragraph=>`<p>${paragraph}</p>`).join("")}null===text_color&&(text_color="000000",localStorage.setItem("text_color",text_color)),$(window).on("focus",function(){editor&&editor.focus()}),$("#dropdown-item-save").removeClass("dropdown-item-disabled"),$(document).ready(async function(){var menu="";menu=(menu=(menu=(menu=(menu=(menu=(menu='<ul class="--puter-menubar"><li><span class="menubar-item">File</span><ul class="dropdown"><li class="dropdown-item" data-action="new">New</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="open">Open</li><li class="dropdown-item" data-action="open-local">Open Local File</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item dropdown-item-disabled" id="dropdown-item-save" data-action="save">Save</li><li class="dropdown-item" data-action="save-as">Save As…</li><li class="dropdown-item" data-action="download">Download</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="print">Print</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="exit">Exit</li></ul></li><li><span class="menubar-item">Edit</span><ul class="dropdown"><li class="dropdown-item" data-action="undo">Undo</li><li class="dropdown-item" data-action="redo">Redo</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="cut">Cut</li><li class="dropdown-item" data-action="copy">Copy</li><li class="dropdown-item" data-action="paste">Paste</li><li class="dropdown-item" data-action="delete">Delete</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="find">Find</li><li class="dropdown-item" data-action="replace">Replace</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="select-all">Select All</li></ul></li><li><span class="menubar-item">AI</span><ul class="dropdown"><li class="dropdown-item" data-action="summarize">Summarize</li>')+`<li class="dropdown-item" data-action="eli5">Explain Like I'm 5!</li>`+'<li class="dropdown-item" data-action="translate">Translate to...</li><li class="dropdown-item" data-action="tone">Tone Analysis</li><li class="dropdown-item" data-action="questions">Generate Questions</li></ul></li><li><span class="menubar-item">Tools</span><ul class="dropdown"><li class="dropdown-item" data-action="sort-lines-asc">Sort Lines Ascending</li><li class="dropdown-item" data-action="sort-lines-desc">Sort Lines Descending</li><li class="dropdown-item" data-action="dedupe-lines">Clear Duplicate Lines</li><li class="dropdown-item" data-action="shuffle-lines">Shuffle Lines</li><li class="dropdown-item" data-action="reverse-lines">Reverse Lines</li><li class="dropdown-item-divider"><hr></li><li class="dropdown-item" data-action="uppercase">UPPER CASE</li><li class="dropdown-item" data-action="lowercase">lower case</li><li class="dropdown-item" data-action="titlecase">Title Case</li><li class="dropdown-item" data-action="snakecase">snake_case</li><li class="dropdown-item" data-action="kebabcase">kebab-case</li></ul></li><li><span class="menubar-item">Format</span><ul class="dropdown"><li class="dropdown-item" data-action="font">Font</li><li class="dropdown-item" data-action="text-color">Text Color</li><li class="dropdown-item" data-action="background-color">Background Color</li></ul></li><li><span class="menubar-item">View</span><ul class="dropdown"><li class="dropdown-item" data-action="zoom-in">Zoom In</li><li class="dropdown-item" data-action="zoom-out">Zoom Out</li><li class="dropdown-item" data-action="restore-default-zoom">Restore Default Zoom</li><li class="dropdown-item-divider"><hr></li>')+`<li class="dropdown-item ${"1"!==show_line_numbers?"dropdown-item-hide-icon":""}" data-action="show-line-numbers">`+'<img src="./img/check.svg" class="dropdown-item-icon"><img src="./img/check-active.svg" class="dropdown-item-icon-active">Show Line Numbers</li>')+`<li class="dropdown-item ${"1"!==line_wrap?"dropdown-item-hide-icon":""}" data-action="toggle-line-wrap">`+'<img src="./img/check.svg" class="dropdown-item-icon"><img src="./img/check-active.svg" class="dropdown-item-icon-active">Word Wrap</li>')+`<li class="dropdown-item ${"1"!==minimap?"dropdown-item-hide-icon":""}" data-action="toggle-minimap">`+'<img src="./img/check.svg" class="dropdown-item-icon"><img src="./img/check-active.svg" class="dropdown-item-icon-active">Show Minimap</li>')+`<li class="dropdown-item ${"1"!==show_status_bar?"dropdown-item-hide-icon":""}" data-action="show-status-bar">`+'<img src="./img/check.svg" class="dropdown-item-icon"><img src="./img/check-active.svg" class="dropdown-item-icon-active">Show Status Bar')+"</li>"+`<li class="dropdown-item ${"1"!==show_doc_stats?"dropdown-item-hide-icon":""}" data-action="show-word-count">`+'<img src="./img/check.svg" class="dropdown-item-icon"><img src="./img/check-active.svg" class="dropdown-item-icon-active">Word Count...</li></ul></li><li><span class="menubar-item">Help</span><ul class="dropdown"><li class="dropdown-item" data-action="about">About</li></ul></li></ul>',$("body").append(menu),$(".dropdown-item").on("mouseup",async function(ev){var action=$(this).attr("data-action");if("exit"===action)attempt_exit();else if("open"===action)curfileViaFileDialog();else if("open-local"===action)unsavedChanges?"Don't Save"===(alert_resp=await puter.ui.alert("Do you want to save the changes you made?",[{label:"Save",type:"primary"},{label:"Don't Save"},{label:"Cancel"}]))?(unsavedChanges=!1,open_local_file()):"Save"===alert_resp&&(unsavedChanges=!1,curfile?save_file(()=>{unsavedChanges=!1,$("#dropdown-item-save").addClass("dropdown-item-disabled"),open_local_file()}):(await puter.ui.showSaveFilePicker(editor.getValue(),default_file_name),open_local_file())):open_local_file();else if("new"===action)puter.ui.launchApp("editor");else if("save-as"===action)curfile=await puter.ui.showSaveFilePicker(editor.getValue(),curfile?curfile.name:default_file_name),unsavedChanges=!1,puter.ui.setWindowTitle(curfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor);else if("summarize"===action)summarize(editor);else if("eli5"===action)eli5(editor);else if("translate"===action){var alert_resp=await puter.ui.prompt("Enter the language you want to translate to:","Translate","Translate");alert_resp&&translate(editor,alert_resp)}else if("tone"===action)toneAnalyzer(editor);else if("questions"===action)generateQuestions(editor);else if("save"===action)curfile?save_file():(curfile=await puter.ui.showSaveFilePicker(editor.getValue(),curfile?curfile.name:default_file_name),unsavedChanges=!1,puter.ui.setWindowTitle(curfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor));else if("download"===action)saveTextAsFile(editor.getValue());else if("print"===action)$("#printer").html(html_encode(editor.getValue())),$("#printer").css({"background-color":background_color,"font-family":font_family,color:text_color}),printJS("printer","html");else if("undo"===action)editor.getModel().undo();else if("redo"===action)editor.getModel().redo(),$('.dropdown-item[data-action="undo"]').removeClass("dropdown-item-disabled");else if("copy"===action)editor.focus(),navigator.clipboard?(alert_resp=window.editor.getModel().getValueInRange(window.editor.getSelection()),await navigator.clipboard.writeText(alert_resp)):document.execCommand("copy");else if("cut"===action)if(editor.focus(),navigator.clipboard){const selection=document.getSelection();await navigator.clipboard.writeText(selection),window.editor.trigger(monaco.KeyCode.Delete,"deleteLeft")}else document.execCommand("cut");else if("paste"===action)editor.focus(),navigator.clipboard?(alert_resp=await navigator.clipboard.readText(),window.editor.getModel().applyEdits([{range:window.editor.getSelection(),text:alert_resp}])):document.execCommand("paste");else if("delete"===action)editor.focus(),editor.trigger(monaco.KeyCode.Delete,"deleteLeft");else if("find"===action)editor.trigger("","actions.find");else if("replace"===action)editor.trigger("","editor.action.startFindReplaceAction");else if("select-all"===action){var alert_resp=editor.getModel().getFullModelRange();editor.setSelection(alert_resp),editor.focus()}else if("sort-lines-asc"===action){var selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);var op={identifier:{major:1,minor:1},range:selection,text:textToTransform.split(/\r?\n/).sort().join("\n"),forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("sort-lines-desc"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);op={identifier:{major:1,minor:1},range:selection,text:textToTransform.split(/\r?\n/).sort().reverse().join("\n"),forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("dedupe-lines"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);op={identifier:{major:1,minor:1},range:selection,text:Array.from(new Set(textToTransform.split(/\r?\n/))).join("\n"),forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("shuffle-lines"===action){var selection=editor.getSelection(),lines=(selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection),textToTransform.split(/\r?\n/));for(let i=lines.length-1;0<i;i--){var j=Math.floor(Math.random()*(i+1));[lines[i],lines[j]]=[lines[j],lines[i]]}op={identifier:{major:1,minor:1},range:selection,text:lines.join("\n"),forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("reverse-lines"===action){var selection=editor.getSelection(),alert_resp=(selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection),textToTransform.split(/\r?\n/).reverse().join("\n")),op={identifier:{major:1,minor:1},range:selection,text:alert_resp,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("uppercase"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);const transformedText=textToTransform.toUpperCase();op={identifier:{major:1,minor:1},range:selection,text:transformedText,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("lowercase"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);const transformedText=textToTransform.toLowerCase();op={identifier:{major:1,minor:1},range:selection,text:transformedText,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("snakecase"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);const transformedText=textToTransform.toLowerCase().replace(/\s+/g,"_");op={identifier:{major:1,minor:1},range:selection,text:transformedText,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("titlecase"===action){selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);const transformedText=textToTransform.split(/\s+/).map(word=>word.charAt(0).toUpperCase()+word.slice(1).toLowerCase()).join(" ");op={identifier:{major:1,minor:1},range:selection,text:transformedText,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else if("kebabcase"===action){var textToTransform,selection=editor.getSelection();selection.startLineNumber===selection.endLineNumber&&selection.startColumn===selection.endColumn?(textToTransform=editor.getValue(),selection=editor.getModel().getFullModelRange()):textToTransform=editor.getModel().getValueInRange(selection);const transformedText=textToTransform.toLowerCase().replace(/\s+/g,"-");op={identifier:{major:1,minor:1},range:selection,text:transformedText,forceMoveMarkers:!0};editor.pushUndoStop(),editor.executeEdits("my-source",[op]),editor.pushUndoStop()}else"text-color"===action?(alert_resp=await puter.ui.showColorPicker({default:null===text_color?void 0:text_color}))&&(text_color=(text_color=alert_resp).replace("#",""),localStorage.setItem("text_color",text_color),monaco.editor.defineTheme("colorTheme",{base:"vs",inherit:!0,rules:[{background:background_color,foreground:text_color}],colors:{"editor.foreground":"#"+text_color,"editor.background":"#"+background_color}}),monaco.editor.setTheme("colorTheme"),$("#editor").css("background-color","#"+background_color)):"background-color"===action?(textToTransform=await puter.ui.showColorPicker({default:null===background_color?void 0:background_color}))&&(background_color=(background_color=textToTransform).replace("#",""),localStorage.setItem("background_color",background_color),monaco.editor.defineTheme("colorTheme",{base:"vs",inherit:!0,rules:[{background:background_color,foreground:text_color}],colors:{"editor.foreground":"#"+text_color,"editor.background":"#"+background_color}}),monaco.editor.setTheme("colorTheme"),$("#editor").css("background-color","#"+background_color)):"font"===action?null!==(selection=await puter.ui.showFontPicker({default:null===font_family?void 0:font_family})).fontFamily&&void 0!==selection.fontFamily&&(font_family=selection.fontFamily,localStorage.setItem("font_family",font_family),editor.updateOptions({fontFamily:selection.fontFamily})):"zoom-in"===action?(editor.updateOptions({fontSize:fontSize+=5}),localStorage.setItem("fontSize",fontSize)):"zoom-out"===action?(editor.updateOptions({fontSize:fontSize-=5}),localStorage.setItem("fontSize",fontSize)):"restore-default-zoom"===action?(fontSize=defaultZoom,editor.updateOptions({fontSize:defaultZoom}),localStorage.setItem("fontSize",fontSize)):"show-line-numbers"===action?"1"===show_line_numbers?(show_line_numbers="0",localStorage.setItem("show_line_numbers","0"),$('[data-action="show-line-numbers"]').addClass("dropdown-item-hide-icon"),editor.updateOptions({lineNumbers:"off",lineNumbersMinChars:0,lineDecorationsWidth:0,quickSuggestions:!1,glyphMargin:!1,folding:!1,renderLineHighlight:"none"})):(show_line_numbers="1",localStorage.setItem("show_line_numbers","1"),$('[data-action="show-line-numbers"]').removeClass("dropdown-item-hide-icon"),editor.updateOptions({lineNumbers:"on",lineNumbersMinChars:1,lineDecorationsWidth:17,glyphMargin:!0})):"toggle-line-wrap"===action?"1"===line_wrap?(line_wrap="0",localStorage.setItem("line_wrap","0"),$('[data-action="toggle-line-wrap"]').addClass("dropdown-item-hide-icon"),editor.updateOptions({wordWrap:"off"})):(line_wrap="1",localStorage.setItem("line_wrap","1"),$('[data-action="toggle-line-wrap"]').removeClass("dropdown-item-hide-icon"),editor.updateOptions({wordWrap:"on"})):"toggle-minimap"===action?"1"===minimap?(minimap="0",localStorage.setItem("minimap","0"),$('[data-action="toggle-minimap"]').addClass("dropdown-item-hide-icon"),editor.updateOptions({minimap:{enabled:!1}})):(minimap="1",localStorage.setItem("minimap","1"),$('[data-action="toggle-minimap"]').removeClass("dropdown-item-hide-icon"),editor.updateOptions({minimap:{enabled:!0}})):"show-status-bar"===action?toggle_status_bar("1"===show_status_bar?"hide":"show"):"show-word-count"===action?toggle_word_count("1"===show_doc_stats?"hide":"show"):"about"===action&&puter.ui.createWindow({title:"About Editor",disable_parent_window:!0,content:`
                    <div style="display: flex; -webkit-font-smoothing: antialiased; flex-direction: column; justify-content: center; align-content: center; height: calc(100vh - 20px); font-family: Arial, Helvetica, sans-serif;">
                        <svg style="margin: 0 auto; width: 70px; height: 70px;" version="1.2" baseProfile="tiny-ps" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48">
                            <title>app-icon-editor-svg</title>
                            <defs>
                                <linearGradient id="grd1" gradientUnits="userSpaceOnUse"  x1="47" y1="39.514" x2="1" y2="8.486">
                                    <stop offset="0" stop-color="#7101e8"  />
                                    <stop offset="1" stop-color="#a589c3"  />
                                </linearGradient>
                            </defs>
                            <style>
                                tspan { white-space:pre }
                                .shp0 { fill: url(#grd1) } 
                                .shp1 { fill: #ffffff } 
                            </style>
                            <g id="Layer">
                                <path id="Layer" class="shp0" d="M47 3L47 45C47 46.1 46.1 47 45 47L3 47C1.9 47 1 46.1 1 45L1 3C1 1.9 1.9 1 3 1L45 1C46.1 1 47 1.9 47 3Z" />
                                <path id="Layer" fill-rule="evenodd" class="shp1" d="M28.62 40L28.62 37.61L32.25 37.22L29.86 30L17.53 30L15.18 37.22L18.76 37.61L18.76 40L8.6 40L8.6 37.66L10.5 37.17C11.21 36.99 11.43 36.86 11.6 36.33L21.33 8L26.45 8L36.36 36.38C36.53 36.91 36.88 36.99 37.42 37.13L39.4 37.61L39.4 40L28.62 40ZM23.76 11.45L18.54 27L28.88 27L23.76 11.45Z" />
                            </g>
                        </svg>
                        <h1 style="text-align:center; font-weight: 500; margin-top:5px;">Editor</h1>
                        <p style="text-align:center; margin-top:0;"><a href="mailto:hi@puter.com" style="text-align:center;">hi@puter.com</a></p>
                        <p style="text-align:center; text-align: center; font-size: 12px; padding: 0 10px; color: #3c474e;">© 2022-2024 Puter Technologies Inc. All rights reserved.</p>
                    </div>
                `,width:350,height:320,is_resizable:!1,has_head:!0,center:!0,show_in_taskbar:!1},()=>{})}),require.config({paths:{vs:"js/monaco-editor/min/vs"}}),require(["vs/editor/editor.main"],function(){var editor_config={value:"",language:"plaintext",fontSize:fontSize,unicodeHighlight:{ambiguousCharacters:!1,invisibleCharacters:!1},minimap:{enabled:!1},automaticLayout:!0},hasSelectionKey=(monaco.editor.defineTheme("colorTheme",{base:"vs",inherit:!0,rules:[{foreground:text_color,background:background_color}],colors:{"editor.foreground":"#"+text_color,"editor.background":"#"+background_color}}),$("#editor").css("background-color","#"+background_color),editor_config.lineNumbers="1"===show_line_numbers?"on":"off",editor_config.lineNumbersMinChars="1"===show_line_numbers?1:0,editor_config.lineDecorationsWidth="1"===show_line_numbers?17:0,editor_config.wordWrap="1"===line_wrap?"on":"off",editor_config.minimap={enabled:"1"===line_wrap},editor_config.quickSuggestions=!1,editor_config.glyphMargin="1"===show_line_numbers,editor_config.folding=!1,editor_config.renderLineHighlight="none",editor_config.autoClosingBrackets=!1,editor_config.matchBrackets=!1,editor_config.selectionHighlight=!1,null!==font_family&&(editor_config.fontFamily=font_family),window.editor=monaco.editor.create(document.getElementById("editor"),editor_config),monaco.editor.setTheme("colorTheme"),editor.createContextKey("hasSelection",!1)),didScrollChangeDisposable=(editor.onDidChangeCursorSelection(function(e){hasSelectionKey.set(!e.selection.isEmpty())}),editor.addAction({id:"summarize",label:"AI Summarize",precondition:"hasSelection",contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:summarize}),editor.onDidScrollChange(function(event){didScrollChangeDisposable.dispose()}));editor.onDidChangeModelContent(function(e){bypassEditorChangeHandlerOnce?bypassEditorChangeHandlerOnce=!1:(unsavedChanges=!0,$("#dropdown-item-save").removeClass("dropdown-item-disabled"),puter.ui.setWindowTitle("● "+(curfile?curfile.name:default_file_name)),$('.dropdown-item[data-action="undo"]').removeClass("dropdown-item-disabled")),show_doc_stats&&update_doc_stats()}),editor.onDidChangeCursorPosition(function(e){var pos=editor.getPosition();$("#pos-line").html(pos.lineNumber),$("#pos-column").html(pos.column)}),editor.focus(),puter.ui.onWindowClose(function(){attempt_exit()}),puter.ui.onItemsOpened(async function(items){var alert_resp;!unsavedChanges||"Don't Save"===(alert_resp=await puter.ui.alert("Do you want to save the changes you made?",[{label:"Save",type:"primary"},{label:"Don't Save"},{label:"Cancel"}]))?(curfile=items[0],unsavedChanges=!1,open_file(curfile)):"Save"===alert_resp&&(curfile?save_file(()=>{curfile=items[0],unsavedChanges=!1,open_file(curfile)}):(await puter.ui.showSaveFilePicker(editor.getValue(),curfile.name),curfile=items[0],unsavedChanges=!1,open_file(curfile)))}),curfile||puter.ui.setWindowTitle(default_file_name),puter.ui.menubar(),$(window).on("resize",async function(){var menubar=$(".--puter-menubar"),extraMenubarHeight=menubar.children().last().position().top;menubar.css("height",`calc(var(--menubar-height) + ${extraMenubarHeight}px)`),$("#editor").css("margin-top",`calc(var(--menubar-height) + ${extraMenubarHeight}px)`)})})}),$(window).on("keydown",async function(event){return!event.ctrlKey&&!event.metaKey||event.shiftKey||83!==event.which?(event.ctrlKey||event.metaKey)&&event.shiftKey&&83===event.which?(event.preventDefault(),event.stopPropagation(),curfile=await puter.ui.showSaveFilePicker(editor.getValue(),curfile?curfile.name:default_file_name),unsavedChanges=!1,puter.ui.setWindowTitle(curfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor),!1):(event.ctrlKey||event.metaKey)&&event.shiftKey&&69===event.which?(event.preventDefault(),event.stopPropagation(),attempt_exit(),!1):!event.ctrlKey&&!event.metaKey||79!==event.which&&"o"!==event.key&&"KeyO"!==event.code?void 0:(event.preventDefault(),event.stopPropagation(),curfileViaFileDialog(),!1):(event.preventDefault(),event.stopPropagation(),curfile?(puter.ui.setWindowTitle(curfile?curfile.name:default_file_name),save_file()):(curfile=await puter.ui.showSaveFilePicker(editor.getValue(),default_file_name),unsavedChanges=!1,puter.ui.setWindowTitle(curfile.name),set_editor_options_based_on_language(get_language_from_filename(curfile.name),editor)),!1)}),$("#editor").on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),$("#editor").on("dragenter",function(e){e.preventDefault(),e.stopPropagation()}),$("#editor").on("drop",async function(e){if(e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length){e.preventDefault(),e.stopPropagation();let file=e.originalEvent.dataTransfer.files[0],reader=new FileReader;unsavedChanges?"Don't Save"===(e=await puter.ui.alert("Do you want to save the changes you made?",[{label:"Save",type:"primary"},{label:"Don't Save"},{label:"Cancel"}]))?(unsavedChanges=!1,puter.ui.setWindowTitle(file.name),set_editor_options_based_on_language(get_language_from_filename(file.name),editor),curfile=void 0,bypassEditorChangeHandlerOnce=!0,reader.readAsText(file),reader.onload=function(event){editor.setValue(event.target.result)}):"Save"===e&&(unsavedChanges=!1,curfile?save_file(()=>{unsavedChanges=!1,$("#dropdown-item-save").addClass("dropdown-item-disabled"),filename=file.name,puter.ui.setWindowTitle(filename),set_editor_options_based_on_language(get_language_from_filename(filename),editor),curfile=void 0,bypassEditorChangeHandlerOnce=!0,reader.readAsText(file),reader.onload=function(event){editor.setValue(event.target.result)}}):(await puter.ui.showSaveFilePicker(editor.getValue(),default_file_name),filename=file.name,puter.ui.setWindowTitle(filename),set_editor_options_based_on_language(get_language_from_filename(filename),editor),curfile=void 0,bypassEditorChangeHandlerOnce=!0,reader.readAsText(file),reader.onload=function(event){editor.setValue(event.target.result)})):(default_file_name=file.name,puter.ui.setWindowTitle(default_file_name),set_editor_options_based_on_language(get_language_from_filename(default_file_name),editor),curfile=void 0,bypassEditorChangeHandlerOnce=!0,reader.readAsText(file),reader.onload=function(event){editor.setValue(event.target.result)})}}),window.onbeforeunload=function(){if(unsavedChanges)return!0},$(document).on("click",".close-x",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove()}),$(document).on("click",".regenerate-questions",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove(),generateQuestions(editor)}),$(document).on("click",".regenerate-translation",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove(),translate(editor,translate_to_lang)}),$(document).on("click",".regenerate-summary",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove(),summarize(editor)}),$(document).on("click",".regenerate-eli5",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove(),eli5(editor)}),$(document).on("click",".regenerate-tone-analyzer",function(){var dialog=$(this).closest("dialog")?.get(0);dialog.close(),dialog.remove(),toneAnalyzer(editor)});