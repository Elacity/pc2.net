import{c as g,A as x,s as C,S as $}from"./loadSts-D8KHyYWS.js";import{n as V,b as G,e as H,f as J,g as Q,h as U,d as X,C as Y,o as Z,E as L,v as O,I as ee,t as ne,i as te,u as oe,j as ie,p as ae,M as ce,q as re,P as le,k as se,l as ue,r as de,R as me,a as fe,m as Ce,T as Se}from"./loadSts-D8KHyYWS.js";import{C as T,g as W}from"./resolveDefaultsModeConfig-DAyFeXzB.js";import{a as pe}from"./resolveDefaultsModeConfig-DAyFeXzB.js";import"./date-utils-Raxu1naD.js";import"./noAuth-BRTlyyWt.js";import"./index-Ch6jWUgG.js";function D(){return async()=>"us-east-1"}class b extends T.classBuilder().ep(g).m(function(n,o,i,t){return[W(i,n.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").sc(x).build(){}const h=e=>{if(typeof(e==null?void 0:e.Arn)=="string"){const n=e.Arn.split(":");if(n.length>4&&n[4]!=="")return n[4]}},k=async(e,n,o,i={})=>{var r;const t=typeof e=="function"?await e():e,l=typeof n=="function"?await n():n;let a="";const c=t??l??(a=await D()());return(r=o==null?void 0:o.debug)==null||r.call(o,"@aws-sdk/client-sts::resolveRegion","accepting first of:",`${t} (credential provider clientConfig)`,`${l} (contextual client)`,`${a} (STS default: AWS_REGION, profile region, or us-east-1)`),c},w=(e,n)=>{let o;return async i=>{var r,s,u,d,m;if(!o){const{logger:S=(r=e==null?void 0:e.parentClientConfig)==null?void 0:r.logger,profile:A=(s=e==null?void 0:e.parentClientConfig)==null?void 0:s.profile,region:p,requestHandler:f=(u=e==null?void 0:e.parentClientConfig)==null?void 0:u.requestHandler,credentialProviderLogger:E,userAgentAppId:R=(d=e==null?void 0:e.parentClientConfig)==null?void 0:d.userAgentAppId}=e,I=await k(p,(m=e==null?void 0:e.parentClientConfig)==null?void 0:m.region,E,{}),y=!P(f);o=new n({...e,userAgentAppId:R,profile:A,region:I,requestHandler:y?f:void 0,logger:S})}const{Credentials:t,AssumedRoleUser:l}=await o.send(new b(i));if(!t||!t.AccessKeyId||!t.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${i.RoleArn}`);const a=h(l),c={accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,sessionToken:t.SessionToken,expiration:t.Expiration,...t.CredentialScope&&{credentialScope:t.CredentialScope},...a&&{accountId:a}};return a&&C(c,"RESOLVED_ACCOUNT_ID","T"),C(c,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),c}},P=e=>{var n;return((n=e==null?void 0:e.metadata)==null?void 0:n.handlerProtocol)==="h2"},v=(e,n)=>n?class extends e{constructor(i){super(i);for(const t of n)this.middlewareStack.use(t)}}:e,z=(e={},n)=>w(e,v($,n));export{T as $Command,V as AssumeRole$,G as AssumeRoleCommand,H as AssumeRoleRequest$,J as AssumeRoleResponse$,x as AssumeRoleWithWebIdentity$,b as AssumeRoleWithWebIdentityCommand,Q as AssumeRoleWithWebIdentityRequest$,U as AssumeRoleWithWebIdentityResponse$,X as AssumedRoleUser$,Y as Credentials$,Z as ExpiredTokenException,L as ExpiredTokenException$,O as IDPCommunicationErrorException,ee as IDPCommunicationErrorException$,ne as IDPRejectedClaimException,te as IDPRejectedClaimException$,oe as InvalidIdentityTokenException,ie as InvalidIdentityTokenException$,ae as MalformedPolicyDocumentException,ce as MalformedPolicyDocumentException$,re as PackedPolicyTooLargeException,le as PackedPolicyTooLargeException$,se as PolicyDescriptorType$,ue as ProvidedContext$,de as RegionDisabledException,me as RegionDisabledException$,$ as STSClient,fe as STSServiceException,Ce as STSServiceException$,Se as Tag$,pe as __Client,z as getDefaultRoleAssumerWithWebIdentity};
